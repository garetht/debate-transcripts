#!/bin/bash

# Pre-commit hook to convert colons to double underscores in JSON filenames
# Save this as .git/hooks/pre-commit and make it executable

# Find all staged JSON files with colons in their names
staged_json_files=$(git diff --cached --name-only --diff-filter=ACM | grep '\.json$' | grep ':')

if [ -n "$staged_json_files" ]; then
    echo "Converting colons to double underscores in JSON filenames..."
    find . -type f -name "*:*" -execdir bash -c 'mv "$1" "${1//:/__}"' _ {} \;
    git add .

    echo "JSON filename conversion complete."
fi

# Continue with the commit
exit 0
